<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="jmpews,jmpews@gmail.com"><title>使用HookZzModules快速逆向理清逻辑 · jmpews</title><meta name="description" content="前言逆向很多的入手情况可能需要找到, 通过 cycript + Reveal 找到当前 View 的 ViewController.
但其实我们可以通过 hook 住 objc_msgSend 提供一些思路, 有个问题就是 objc_msgSend 调用过于频繁, 不能所有都打印, 那么可以借助 H"><meta name="keywords" content="py,go,pwn,reverse"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">jmpews</a></h3><div class="description"><p>py &amp; go &amp; pwn &amp; reverse</p></div></div></div><ul class="social-links"><li><a href="https://twitter.com/jmpews"><i class="fa fa-twitter"></i></a></li><li><a href="http://weibo.com/winter1ife"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/jmpews"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>使用HookZzModules快速逆向理清逻辑</a></h3></div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>逆向很多的入手情况可能需要找到, 通过 <code>cycript</code> + <code>Reveal</code> 找到当前 <code>View</code> 的 <code>ViewController</code>.</p>
<p>但其实我们可以通过 hook 住 <code>objc_msgSend</code> 提供一些思路, 有个问题就是 <code>objc_msgSend</code> 调用过于频繁, 不能所有都打印, 那么可以借助 <a href="https://github.com/jmpews/HookZz" target="_blank" rel="external">HookZz</a> 搞一些事情.</p>
<p>可能有人疑问, 这个和 <code>logify</code> 关系.</p>
<ol>
<li>打印通用 <code>ViewController</code>, 无需具体的类.</li>
<li>显示调用层级.</li>
</ol>
<h2 id="hook-objc-msgSend"><a href="#hook-objc-msgSend" class="headerlink" title="hook_objc_msgSend"></a>hook_objc_msgSend</h2><p>具体细节可以查看代码. <a href="https://github.com/jmpews/HookZzModules/tree/master/hook_objc_msgSend" target="_blank" rel="external">Move to hook_objc_msgSend</a></p>
<p>本来想解析一下参数的, 没解析完, 有兴趣的可以参考 <a href="https://github.com/DavidGoldman/InspectiveC/blob/299cef1c40e8a165c697f97bcd317c5cfa55c4ba/logging.mm" target="_blank" rel="external">Move to InspectiveC</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">void objc_msgSend_pre_call(RegState *rs, ThreadStack *threadstack, CallStack *callstack) &#123;</div><div class="line">    char *sel_name = (char *)rs-&gt;general.regs.x1;</div><div class="line">    // No More Work Here!!! it will be slow.</div><div class="line">    if(sel_name &gt; log_sel_start_addr &amp;&amp; sel_name &lt; log_sel_end_addr) &#123;</div><div class="line">        // bad code! correct-ref: https://github.com/DavidGoldman/InspectiveC/blob/299cef1c40e8a165c697f97bcd317c5cfa55c4ba/logging.mm#L27</div><div class="line">        void *class_addr = object_getClass((void *)rs-&gt;general.regs.x0);</div><div class="line">        void *super_class_addr = class_getSuperclass(class_addr);</div><div class="line">        // KVO 2333</div><div class="line">        if((class_addr &gt; log_class_start_addr &amp;&amp; class_addr &lt; log_class_end_addr) || (super_class_addr &gt; log_class_start_addr &amp;&amp; super_class_addr &lt; log_class_end_addr)) &#123;</div><div class="line">            memset(decollators, 45, 128);</div><div class="line">            decollators[threadstack-&gt;size * 3] = &apos;\0&apos;;</div><div class="line">            char *class_name = ((const char *(*)(void *))object_getClassName)(class_addr);</div><div class="line">            unsigned int class_name_length = strlen(class_name);</div><div class="line">            </div><div class="line">            // check View</div><div class="line">            // if(class_name_length &gt;= 4 &amp;&amp; !strcmp((class_name + class_name_length - 4), &quot;View&quot;)) &#123;</div><div class="line">            //     NSLog(@&quot;thread-id: %ld | %s [%s %s]&quot;, threadstack-&gt;thread_id, decollators, class_name, sel_name);</div><div class="line">            // &#125;</div><div class="line"></div><div class="line">            // check ViewController</div><div class="line">            if(class_name_length &gt;= 14 &amp;&amp; !strcmp((class_name + class_name_length - 14), &quot;ViewController&quot;)) &#123;</div><div class="line">                #if 1</div><div class="line">                NSLog(@&quot;thread-id: %ld | %s [%s %s]&quot;, threadstack-&gt;thread_id, decollators, class_name, sel_name);</div><div class="line">                #else</div><div class="line">                Method method = class_getInstanceMethod(class_addr, sel_name);</div><div class="line">                int num_args = method_getNumberOfArguments(method);</div><div class="line">                char method_name[128] = &#123;0&#125;;</div><div class="line">                char sel_name_tmp[128] = &#123;0&#125;;</div><div class="line">                char *x;</div><div class="line">                char *y;</div><div class="line">                x = sel_name_tmp;</div><div class="line">                strcpy(sel_name_tmp, sel_name);</div><div class="line">                if(!strchr(x, &apos;:&apos;)) &#123;</div><div class="line">                    NSLog(@&quot;thread-id: %ld | %s [%s %s]&quot;, threadstack-&gt;thread_id, decollators, class_name, sel_name_tmp);</div><div class="line">                    return;</div><div class="line"></div><div class="line">                &#125;</div><div class="line">                for (int i=2; strchr(x, &apos;:&apos;) &amp;&amp; i &lt; num_args; i++) &#123;</div><div class="line">                    y = strchr(x, &apos;:&apos;);</div><div class="line">                    *y = &apos;\0&apos;;</div><div class="line">                    char *type_name = method_copyArgumentType(method, i);</div><div class="line">                    sprintf(method_name + strlen(method_name), &quot;%s:&quot;, x);</div><div class="line">                    sprintfArg(method_name + strlen(method_name), rs, i, type_name);</div><div class="line">                    x = y + 1;</div><div class="line">                &#125;</div><div class="line">                NSLog(@&quot;thread-id: %ld | %s [%s %s]&quot;, threadstack-&gt;thread_id, decollators, class_name, method_name);</div><div class="line">                #endif</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>既然大家都喜欢搞 WeChat, 那以 WeChat 撤回消息举个例子, 整个撤回大概是这么个流程. 这里感谢庆总的 <a href="https://github.com/AloneMonkey/MonkeyDev" target="_blank" rel="external">MonkeyDev</a>, 可以快速测试 WeChat, 之后应该会将该工具移植到 <a href="https://github.com/AloneMonkey/MonkeyDev" target="_blank" rel="external">MonkeyDev</a>.</p>
<p>那么其实在这里已经可以看出具体的逻辑了, 下面可能用 <code>awk</code> 处理了一下更清楚了.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line">2017-09-05 15:04:29.382925+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------ [NSKVONotifying_BaseMsgContentViewController MessageReturn:MessageInfo:Event:]</div><div class="line">2017-09-05 15:04:29.392743+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------- [NSKVONotifying_BaseMsgContentViewController OnMsgRevoked:n64MsgId:SysMsg:]</div><div class="line">2017-09-05 15:04:29.392994+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------ [NSKVONotifying_BaseMsgContentViewController GetContact]</div><div class="line">2017-09-05 15:04:29.517825+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------ [NSKVONotifying_BaseMsgContentViewController MessageReturn:MessageInfo:Event:]</div><div class="line">2017-09-05 15:04:29.524797+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------ [NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">2017-09-05 15:04:29.525046+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------ [NSKVONotifying_BaseMsgContentViewController addMessageNode:layout:addMoreMsg:]</div><div class="line">2017-09-05 15:04:29.525195+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">2017-09-05 15:04:29.525369+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getCurContentSizeHeight]</div><div class="line">2017-09-05 15:04:29.526230+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">2017-09-05 15:04:29.526389+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">2017-09-05 15:04:29.526518+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">2017-09-05 15:04:29.526577+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------- [NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">2017-09-05 15:04:29.526628+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------- [NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">2017-09-05 15:04:29.526740+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">2017-09-05 15:04:29.526839+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">2017-09-05 15:04:29.526897+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">2017-09-05 15:04:29.526948+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------- [NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">2017-09-05 15:04:29.526999+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------- [NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">2017-09-05 15:04:29.527064+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController isShowHeadImage:]</div><div class="line">2017-09-05 15:04:29.527435+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getMessageChatContactByMessageWrap:]</div><div class="line">2017-09-05 15:04:29.529299+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getCurContentSizeHeight]</div><div class="line">2017-09-05 15:04:29.540957+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">2017-09-05 15:04:29.607821+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_BaseMsgContentViewController didFinishedLoading:]</div><div class="line">2017-09-05 15:04:29.608005+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController ScrollToBottomAnimated:]</div><div class="line">2017-09-05 15:04:29.609417+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">2017-09-05 15:04:29.609570+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------------------------------------------- [NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">2017-09-05 15:04:29.609650+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------------------------------------------- [NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">2017-09-05 15:04:29.609720+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">2017-09-05 15:04:29.609791+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">2017-09-05 15:04:29.657073+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_NewMainFrameViewController updateSession:]</div><div class="line">2017-09-05 15:04:29.661082+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_NewMainFrameViewController reloadSessions]</div><div class="line">2017-09-05 15:04:29.670737+0800 WeChat[48799:11942594] [WC] WCSession is not paired</div><div class="line">2017-09-05 15:04:29.672210+0800 WeChat[48799:11942594] [WC] -[WCSession onqueue_notifyOfUserInfoError:withUserInfoTransfer:]_block_invoke dropping as pairingIDs no longer match. pairingID (null), client pairingID: (null)</div><div class="line">2017-09-05 15:04:29.673883+0800 WeChat[48799:11942591] [WC] no pairingID</div><div class="line">2017-09-05 15:04:29.695792+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------- [NSKVONotifying_NewMainFrameViewController updateStatusBar]</div><div class="line">2017-09-05 15:04:29.696051+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------- [NSKVONotifying_NewMainFrameViewController updateSession:]</div><div class="line">2017-09-05 15:04:29.699496+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_NewMainFrameViewController reloadSessions]</div><div class="line">2017-09-05 15:04:29.755781+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_NewMainFrameViewController updateStatusBar]</div><div class="line">2017-09-05 15:04:29.756042+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------ [NSKVONotifying_NewMainFrameViewController updateSession:]</div><div class="line">2017-09-05 15:04:29.759650+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_NewMainFrameViewController reloadSessions]</div><div class="line">2017-09-05 15:04:29.771645+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.777169+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.782692+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.792774+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.798065+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.803573+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.813564+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.818924+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.824741+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.830379+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.839838+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.844709+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.854562+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.860159+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------------------------------------------ [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.886389+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------- [NSKVONotifying_BaseMsgContentViewController deleteNode:withDB:animated:]</div><div class="line">2017-09-05 15:04:29.886569+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------ [NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">2017-09-05 15:04:29.886825+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------ [NSKVONotifying_BaseMsgContentViewController findNodeIndexByLocalId:]</div><div class="line">2017-09-05 15:04:29.887270+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------ [NSKVONotifying_BaseMsgContentViewController removeObjectsFromMessageNodeDatas:]</div><div class="line">2017-09-05 15:04:29.887521+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------- [NSKVONotifying_BaseMsgContentViewController getLastSentMsg]</div><div class="line">2017-09-05 15:04:29.888255+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------- [NSKVONotifying_BaseMsgContentViewController updateMessageNodeStatus:]</div><div class="line">2017-09-05 15:04:29.888334+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------ [NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">2017-09-05 15:04:29.919073+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------------------------------------- [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.924847+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------------------------------------------- [NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">2017-09-05 15:04:29.994115+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------ [NSKVONotifying_BaseMsgContentViewController getCurContentSizeHeight]</div><div class="line">2017-09-05 15:04:29.994933+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------ [NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">2017-09-05 15:04:29.995051+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------- [NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">2017-09-05 15:04:29.995115+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------- [NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">2017-09-05 15:04:29.995168+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------ [NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">2017-09-05 15:04:29.995220+0800 WeChat[48799:11942122] thread-id: 7123647296 | ------------------ [NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">2017-09-05 15:04:30.000301+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">2017-09-05 15:04:30.000701+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">2017-09-05 15:04:30.001095+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">2017-09-05 15:04:30.001367+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">2017-09-05 15:04:30.001725+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------------- [NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">2017-09-05 15:04:46.929071+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------- [NSKVONotifying_NewMainFrameViewController updateAllItemTimeLabel]</div><div class="line">2017-09-05 15:05:46.924535+0800 WeChat[48799:11942122] thread-id: 7123647296 | --------------- [NSKVONotifying_NewMainFrameViewController updateAllItemTimeLabel]</div></pre></td></tr></table></figure>
<p>其实整个过程在 xcode 的控制台下还是很清楚, 有同学可以再做一下输出的优化, 这里我直接用 <code>awk</code> 处理下.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line">------------------[NSKVONotifying_BaseMsgContentViewController MessageReturn:MessageInfo:Event:]</div><div class="line">---------------------------[NSKVONotifying_BaseMsgContentViewController OnMsgRevoked:n64MsgId:SysMsg:]</div><div class="line">------------------------------[NSKVONotifying_BaseMsgContentViewController GetContact]</div><div class="line">------------------[NSKVONotifying_BaseMsgContentViewController MessageReturn:MessageInfo:Event:]</div><div class="line">------------------[NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">------------------[NSKVONotifying_BaseMsgContentViewController addMessageNode:layout:addMoreMsg:]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getCurContentSizeHeight]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">------------------------[NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">------------------------[NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">---------------------------[NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">---------------------------[NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">------------------------[NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">------------------------[NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">---------------------------[NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">---------------------------[NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController isShowHeadImage:]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getMessageChatContactByMessageWrap:]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getCurContentSizeHeight]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">------------------------[NSKVONotifying_BaseMsgContentViewController didFinishedLoading:]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController ScrollToBottomAnimated:]</div><div class="line">------------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">---------------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">---------------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">------------------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">------------------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">------------------------[NSKVONotifying_NewMainFrameViewController updateSession:]</div><div class="line">---------------------[NSKVONotifying_NewMainFrameViewController reloadSessions]</div><div class="line">notpaired </div><div class="line">droppingas pairingIDs</div><div class="line"> </div><div class="line">---------------------------[NSKVONotifying_NewMainFrameViewController updateStatusBar]</div><div class="line">---------------------------[NSKVONotifying_NewMainFrameViewController updateSession:]</div><div class="line">------------------------[NSKVONotifying_NewMainFrameViewController reloadSessions]</div><div class="line">------------------------[NSKVONotifying_NewMainFrameViewController updateStatusBar]</div><div class="line">------------------------[NSKVONotifying_NewMainFrameViewController updateSession:]</div><div class="line">---------------------[NSKVONotifying_NewMainFrameViewController reloadSessions]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">---------[NSKVONotifying_BaseMsgContentViewController deleteNode:withDB:animated:]</div><div class="line">------------[NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">------------[NSKVONotifying_BaseMsgContentViewController findNodeIndexByLocalId:]</div><div class="line">------------[NSKVONotifying_BaseMsgContentViewController removeObjectsFromMessageNodeDatas:]</div><div class="line">---------------[NSKVONotifying_BaseMsgContentViewController getLastSentMsg]</div><div class="line">---------------[NSKVONotifying_BaseMsgContentViewController updateMessageNodeStatus:]</div><div class="line">------------------[NSKVONotifying_BaseMsgContentViewController findNodeDataByLocalId:]</div><div class="line">---------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">---------------------------------------------------------[NSKVONotifying_BaseMsgContentViewController makeCell:indexPath:]</div><div class="line">------------[NSKVONotifying_BaseMsgContentViewController getCurContentSizeHeight]</div><div class="line">------------[NSKVONotifying_BaseMsgContentViewController getTableViewVisibleHeightWithOrientation:]</div><div class="line">---------------[NSKVONotifying_BaseMsgContentViewController getSearchBarHeight]</div><div class="line">---------------[NSKVONotifying_BaseMsgContentViewController getTipsHeight]</div><div class="line">------------------[NSKVONotifying_BaseMsgContentViewController getAddFriendTipHeight]</div><div class="line">------------------[NSKVONotifying_BaseMsgContentViewController getSecurityBannerTipHeight]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">---------------------[NSKVONotifying_BaseMsgContentViewController getContentViewY]</div><div class="line">---------------[NSKVONotifying_NewMainFrameViewController updateAllItemTimeLabel]</div><div class="line">---------------[NSKVONotifying_NewMainFrameViewController updateAllItemTimeLabel]</div></pre></td></tr></table></figure></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-09-05</span><i class="fa fa-tag"></i><a href="/categories/darwin/" title="darwin" class="tag">darwin </a><a href="/tags/debug/" title="debug" class="tag">debug </a><a href="/tags/HookZz/" title="HookZz" class="tag">HookZz </a><a href="/tags/HookZzModules/" title="HookZzModules" class="tag">HookZzModules </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://jmpews.github.com/2017/09/05/darwin/使用HookZzMoudule快速逆向/,jmpews,使用HookZzModules快速逆向理清逻辑,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2017/09/02/darwin/Runloop学习/" title="RunLoop 学习" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2017/09/14/pwn/frida-gum源码解析-架构篇/" title="frida-gum源码解析-架构篇[doing]" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>